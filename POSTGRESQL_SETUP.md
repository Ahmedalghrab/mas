# ๐๏ธ ุฅุนุฏุงุฏ PostgreSQL ุนูู Railway - ุญู ูุดููุฉ ุญุฐู ุงูุจูุงูุงุช

## โ๏ธ ุงููุดููุฉ
- SQLite ุนูู Railway ููุญุฐู ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู
- ุงูุตูุฑ ุงููุฑููุนุฉ ุชูุญุฐู
- ุฃู ุชุนุฏููุงุช ุชุฎุชูู ุจุนุฏ ุฅุนุงุฏุฉ ูุดุฑ ุงูุชุทุจูู

## โ ุงูุญู: PostgreSQL (ูุฌุงูู ูุฏุงุฆู)

---

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ (5 ุฏูุงุฆู)

### 1๏ธโฃ ุฅุถุงูุฉ PostgreSQL ูู Railway

1. ุงูุชุญ ูุดุฑูุนู ูู Railway: https://railway.app/project/[your-project-id]
2. ุงุถุบุท **+ New**
3. ุงุฎุชุฑ **Database**
4. ุงุฎุชุฑ **Add PostgreSQL**
5. ุงูุชุธุฑ ุญุชู ูุชู ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 2๏ธโฃ ุฑุจุท ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงูุชุทุจูู

1. ุงุถุบุท ุนูู **PostgreSQL** service
2. ุงุฐูุจ ุฅูู **Variables**
3. ุงูุณุฎ ูููุฉ **DATABASE_URL** 

ูุซุงู:
```
postgresql://postgres:password@postgres.railway.internal:5432/railway
```

4. ุงุฐูุจ ุฅูู **mas service** (ุงูุชุทุจูู ุงูุฑุฆูุณู)
5. ุงุฐูุจ ุฅูู **Variables**
6. ุงุญุฐู ุฃู ุนุฏูู: `ConnectionStrings__DefaultConnection`
7. ุฃุถู ุงููุชุบูุฑ ุงูุฌุฏูุฏ:
   - **Key**: `ConnectionStrings__DefaultConnection`
   - **Value**: ุงูุตู ุงูู DATABASE_URL ุงูุฐู ูุณุฎุชู

---

### 3๏ธโฃ ุชุดุบูู Migrations (ููู ุฌุฏุงู!)

ุจุนุฏ ุฑุจุท ูุงุนุฏุฉ ุงูุจูุงูุงุชุ **ูุฌุจ ุชุดุบูู Migrations**:

#### ุงูุทุฑููุฉ 1: ูู Railway CLI
```powershell
railway run dotnet ef database update
```

#### ุงูุทุฑููุฉ 2: ูู ููุญุฉ Railway
1. ุงุฐูุจ ุฅูู **Deployments**
2. ุงูุชุญ **Latest Deployment**
3. ุงุถุบุท ุนูู **3 dots (...)** โ **View Logs**
4. ุฅุฐุง ุฑุฃูุช ุฃุฎุทุงุก migrationsุ ุงุฐูุจ ููุทุฑููุฉ 3

#### ุงูุทุฑููุฉ 3: ุชุดุบูู ูุญููุงู ุซู ูุดุฑ
```powershell
# ูู PowerShell
cd C:\halah\mas

# ุงุถุจุท connection string ูุคูุชุงู
$env:ConnectionStrings__DefaultConnection = "Host=containers-us-west-xxx.railway.app;Port=xxxx;Database=railway;Username=postgres;Password=xxxxx"

# ุดุบู migrations
cd mas
dotnet ef database update

# ุงุฑูุน ุงูุชุญุฏูุซุงุช
cd ..
git push
```

---

### 4๏ธโฃ ุชุญุฏูุซ appsettings.Production.json (ุชู ุจุงููุนู)

ุชู ุชุญุฏูุซ ุงูููุฏ ููุฏุนู PostgreSQL ุชููุงุฆูุงู! ุงูุชุทุจูู ููุชุดู ููุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู connection string.

---

## ๐ ุงูุชุญุฏูุซุงุช ุงูุชู ุชูุช

โ ุชุซุจูุช `Npgsql.EntityFrameworkCore.PostgreSQL`
โ ุชุญุฏูุซ `Program.cs` ููุฏุนู SQLite ู PostgreSQL
โ ุงูููุฏ ูุฎุชุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูููุงุณุจุฉ ุชููุงุฆูุงู

---

## ๐ฏ ุจุนุฏ ุงูุฅุนุฏุงุฏ

### ุณูุชู ุญูุธ ุงูุจูุงูุงุช ุจุดูู ุฏุงุฆู:
- โ ุงูุฎุฏูุงุช ูุงูููุชุฌุงุช
- โ ุงูุตูุฑ ุงููุฑููุนุฉ (ุณูุชู ุญููุง ูู ุงูุฎุทูุฉ ุงูุชุงููุฉ)
- โ ุฅุนุฏุงุฏุงุช ุงููููุน
- โ ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช

### ๐ผ๏ธ ุญู ูุดููุฉ ุงูุตูุฑ (ุฎุทูุฉ ุฅุถุงููุฉ)

ุงูุตูุฑ ุชูุญูุธ ุญุงููุงู ูู `/wwwroot/uploads` ููู ูุคูุชุฉ ุฃูุถุงู.

**ุงูุญููู:**

#### ุงูุญู 1: ุงุณุชุฎุฏุงู Cloudinary (ููุตู ุจู)
```csharp
// ูุฌุงูู: 25GB storage + 25GB bandwidth ุดูุฑูุงู
// ุณุฑูุน: CDN ุนุงููู
// ุณูู: API ุจุณูุท
```

#### ุงูุญู 2: ุงุณุชุฎุฏุงู Railway Volume
1. ูู Railway โ Service โ Settings
2. Add Volume:
   - **Mount Path**: `/app/wwwroot/uploads`
3. ุณูุชู ุญูุธ ุงูุตูุฑ ุจุดูู ุฏุงุฆู

---

## ๐ ููุงุฑูุฉ ุงูุญููู

| ุงูููุฒุฉ | SQLite (ูุคูุช) | PostgreSQL | Railway Volume |
|--------|----------------|------------|----------------|
| **ุญูุธ ุงูุจูุงูุงุช** | โ ููุญุฐู | โ ุฏุงุฆู | โ ุฏุงุฆู |
| **ุงูุณุฑุนุฉ** | โก ุณุฑูุน ุฌุฏุงู | โก ุณุฑูุน | โก ุณุฑูุน |
| **ุงูุชูููุฉ** | ๐ ูุฌุงูู | ๐ ูุฌุงูู | ๐ ูุฌุงูู |
| **ุงููุณุฎ ุงูุงุญุชูุงุทู** | โ | โ ุชููุงุฆู | โ๏ธ ูุฏูู |
| **ุงูุชูุณุน** | โ ูุญุฏูุฏ | โ ููุชุงุฒ | โ๏ธ ูุญุฏูุฏ |

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "Could not load file or assembly 'Npgsql'"
```bash
dotnet restore
dotnet build
git add .
git commit -m "Add PostgreSQL support"
git push
```

### ุฎุทุฃ: "Migrations pending"
```bash
railway run dotnet ef database update
```

### ุฎุทุฃ: "Connection refused"
ุชุฃูุฏ ูู:
- โ DATABASE_URL ุตุญูุญ
- โ PostgreSQL service ูุนูู
- โ ุงููุชุบูุฑุงุช ูุญููุธุฉ ูู Railway

---

## ๐ฑ ุงูุชุญูู ูู ูุฌุงุญ ุงูุฅุนุฏุงุฏ

1. ุงูุชุญ ุงูุชุทุจูู: `https://mas-production-8fc5.up.railway.app`
2. ุณุฌู ุฏุฎูู ูุฃุถู ุฎุฏูุฉ ุฌุฏูุฏุฉ
3. ูู Railway โ **Redeploy** ุงูุชุทุจูู
4. ุงูุชุญ ุงูุชุทุจูู ูุฑุฉ ุฃุฎุฑู
5. โ ูุฌุจ ุฃู ุชุฌุฏ ุงูุฎุฏูุฉ ููุฌูุฏุฉ!

---

## ๐ ุงูุฎูุงุตุฉ

ุจุนุฏ ุฅุนุฏุงุฏ PostgreSQL:
- โ **ูุง ูุฒูุฏ ูู ุญุฐู ุงูุจูุงูุงุช**
- โ **ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู**
- โ **ุฃุฏุงุก ุฃูุถู**
- โ **ูุงุจููุฉ ุชูุณุน ููุชุงุฒุฉ**

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ูุดููุฉ:
1. ุชุญูู ูู Logs ูู Railway
2. ุชุฃูุฏ ูู connection string ุตุญูุญ
3. ุชุฃูุฏ ูู ุชุดุบูู migrations

**ุชู ุงูุฅุนุฏุงุฏ! ุงูุขู ุชุทุจููู ุฌุงูุฒ ููุฅูุชุงุฌ ุงูุญูููู! ๐**
