@rendermode InteractiveServer

@if (testimonials != null && testimonials.Any())
{
    <section class="testimonials-section py-5 bg-light">
        <div class="container">
     <div class="text-center mb-5">
      <h2 class="display-5 fw-bold text-primary mb-3">
    <i class="bi bi-chat-quote"></i> آراء عملائنا
    </h2>
         <p class="lead text-muted">ماذا يقول عملاؤنا عن خدماتنا؟</p>
</div>

         <div class="row g-4">
    @foreach (var testimonial in testimonials.Take(3))
            {
       <div class="col-md-4">
  <div class="card testimonial-card border-0 shadow-sm h-100">
    <div class="card-body p-4">
      <div class="rating mb-3">
         @for (int i = 1; i <= 5; i++)
       {
         @if (i <= testimonial.Rating)
   {
         <i class="bi bi-star-fill text-warning"></i>
       }
 else
     {
   <i class="bi bi-star text-muted"></i>
  }
       }
  </div>
   <p class="card-text text-muted mb-4">
      "@testimonial.TestimonialText"
  </p>
   <div class="d-flex align-items-center">
    @if (!string.IsNullOrEmpty(testimonial.CustomerImage))
      {
  <img src="@testimonial.CustomerImage" alt="@testimonial.CustomerName" 
   class="rounded-circle me-3" style="width: 50px; height: 50px; object-fit: cover;" />
    }
       else
 {
    <div class="rounded-circle bg-primary bg-opacity-10 text-primary me-3 d-flex align-items-center justify-content-center"
          style="width: 50px; height: 50px;">
       <i class="bi bi-person fs-4"></i>
  </div>
      }
    <div>
       <h6 class="mb-0 fw-bold">@testimonial.CustomerName</h6>
      @if (!string.IsNullOrEmpty(testimonial.CustomerTitle))
  {
     <small class="text-muted">@testimonial.CustomerTitle</small>
    }
    </div>
     </div>
 </div>
    </div>
     </div>
}
    </div>
        </div>
    </section>
}

@code {
 [Inject] private HttpClient Http { get; set; } = default!;

    private List<TestimonialDto>? testimonials;

    protected override async Task OnInitializedAsync()
    {
   await LoadTestimonials();
    }

    private async Task LoadTestimonials()
    {
  try
 {
       testimonials = await Http.GetFromJsonAsync<List<TestimonialDto>>("/api/testimonials?isActive=true");
   }
     catch { }
    }

    public class TestimonialDto
  {
 public int Id { get; set; }
     public string CustomerName { get; set; } = "";
     public string? CustomerTitle { get; set; }
        public string? CustomerImage { get; set; }
        public string TestimonialText { get; set; } = "";
   public int Rating { get; set; }
    }
}

<style>
    .testimonial-card {
        transition: all 0.3s ease;
    }

    .testimonial-card:hover {
     transform: translateY(-10px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15) !important;
    }

    .testimonial-card .card-text {
  position: relative;
        font-style: italic;
    }

    .testimonial-card .card-text::before {
     content: '"';
   font-size: 4rem;
        position: absolute;
        top: -30px;
 left: -10px;
   color: var(--primary-color);
        opacity: 0.1;
    }
</style>
