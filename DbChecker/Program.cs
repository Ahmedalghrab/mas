using Microsoft.EntityFrameworkCore;
using mas.Data;
using mas.Models;
using System.Text;

namespace DbChecker
{
    class Program
    {
        static async Task Main(string[] args)
        {
 Console.OutputEncoding = Encoding.UTF8;

  var optionsBuilder = new DbContextOptionsBuilder<ApplicationDbContext>();
 optionsBuilder.UseSqlite("Data Source=mas.db");

            using var context = new ApplicationDbContext(optionsBuilder.Options);

 Console.WriteLine("???????????????????????????????????????");
       Console.WriteLine("?? ??? ???????? ?? ????? ????????");
      Console.WriteLine("???????????????????????????????????????\n");

            // ??? ????????
     var productsCount = await context.Products.CountAsync();
    var products = await context.Products.Take(3).ToListAsync();
            
   Console.WriteLine($"?? ??? ????????: {productsCount}");
            
     if (products.Any())
      {
        Console.WriteLine("\n?? ??? 3 ??????:");
              foreach (var product in products)
      {
            Console.WriteLine($"  - ID: {product.Id}");
     Console.WriteLine($"    ?????: '{product.NameAr}'");
         Console.WriteLine($"    ?????: {product.Price} ?.?");
        
        // ??? ??? ??? ????? ??? ???
         if (product.NameAr.Contains("?"))
  {
    Console.WriteLine($"    ??  ?????: ????? ??? ?????? ???????!");
         }
  else
 {
         Console.WriteLine($"    ? ???? ????");
            }
 Console.WriteLine();
       }
      }
            else
            {
                Console.WriteLine("? ?? ???? ?????? ?? ????? ????????!");
  }

            // ??? ?????????
 var categoriesCount = await context.Categories.CountAsync();
            Console.WriteLine($"\n??? ??? ?????????: {categoriesCount}");

      Console.WriteLine("\n???????????????????????????????????????");
 }
    }
}
